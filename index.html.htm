<!DOCTYPE html>
<html>
<head>
  <title>AmiViz — Event Registration</title>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <!-- Excel generator (SheetJS) - with graceful CSV fallback if offline -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js" integrity="sha512-z4bF7s1eFxAfs/0g0kf2zvO3d5M1oQ8Y3bT3oGk1R8s0lXd7LhlvQm0lJ6Jk0T9m0x3Y9M5Qf2m2yVx5v5YzVg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  <style>
    :root{
      --brand:#ff7f4f;  /* AmiViz orange */
      --ink:#2b2b2b;    /* dark gray text */
      --muted:#6b7380;
      --danger:#b00020;
      --ok:#12824c;
      --bg:#fafafa;
    }
    *{box-sizing:border-box}
    body{
      font-family: system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      color:var(--ink);
      background:var(--bg);
      margin:0; padding:24px;
    }
    .wrap{max-width:720px;margin:0 auto}
    .card{
      background:#fff; border-radius:14px; padding:24px 22px; margin:16px auto;
      box-shadow:0 8px 30px rgba(0,0,0,.08);
    }
    .hero{
      display:flex; align-items:center; gap:16px; margin-bottom:8px;
    }
    .hero .brandmark{
      display:none; /* shown only if PNG not found */
      font-weight:800; font-size:28px; letter-spacing:.3px; color:#2b2b2b;
    }
    .hero .brandmark::before{
      content:""; display:inline-block; width:28px; height:28px; margin-right:8px;
      background: conic-gradient(from 45deg, var(--brand) 0 25%, transparent 0 100%),
                  linear-gradient(var(--brand),var(--brand));
      -webkit-mask:
        radial-gradient(circle at 50% 50%, #000 65%, transparent 66%) subtract,
        polygon(25% 0, 75% 0, 100% 50%, 75% 100%, 25% 100%, 0 50%) center/100% 100% no-repeat;
      mask:
        radial-gradient(circle at 50% 50%, #000 65%, transparent 66%) subtract,
        polygon(25% 0, 75% 0, 100% 50%, 75% 100%, 25% 100%, 0 50%) center/100% 100% no-repeat;
    }
    h1,h2{margin:0 0 12px;}
    .subtitle{color:var(--muted); margin:2px 0 18px; font-size:14px;}
    label{display:block; margin-top:12px; font-weight:600;}
    input{
      width:100%; padding:12px 11px; margin-top:6px; border:1px solid #dcdcdc;
      border-radius:10px; font-size:15px; outline:none; background:#fff;
    }
    input:focus{border-color:var(--brand); box-shadow:0 0 0 3px rgba(255,127,79,.15);}
    .btn{
      margin-top:18px; width:100%; padding:12px 14px; border:none; border-radius:10px;
      color:#fff; background:var(--brand); font-size:16px; font-weight:700; cursor:pointer;
    }
    .btn:hover{filter:brightness(1.05)}
    .note{font-size:13px; color:var(--muted); margin-top:8px;}
    .success{color:var(--ok)}
    .err{color:var(--danger); font-weight:600; margin-top:10px;}
    .hidden{display:none;}
    .center{text-align:center;}
    .footer{max-width:720px; margin:12px auto 0; color:#999; font-size:12px; text-align:center; position:relative;}
    /* Popup */
    .modal{
      position:fixed; inset:0; display:none; align-items:center; justify-content:center;
      background:rgba(0,0,0,.4); z-index:20; padding:20px;
    }
    .modal-inner{
      background:#fff; max-width:520px; width:100%; border-radius:12px; padding:22px;
      box-shadow:0 10px 30px rgba(0,0,0,.2);
    }
    .modal h3{margin:0 0 8px}
    .modal p{margin:0 0 6px; line-height:1.45}
    .modal .close{
      margin-top:14px; border:none; background:#222; color:#fff; padding:10px 14px; border-radius:8px; cursor:pointer;
    }
    /* Invisible admin trigger (bottom-left). Click 3x quickly. */
    #secretAdmin{
      position:fixed; left:8px; bottom:8px; width:28px; height:28px; opacity:0; z-index:50;
      background:transparent; border:none; cursor:pointer;
    }
    #adminPanel{
      display:none; margin-top:16px; border:1px dashed #cfd4e0; border-radius:12px; padding:16px;
    }
    #adminPanel h3{margin:0 0 12px;}
    .pill{display:inline-block; padding:3px 10px; background:#eee; border-radius:100px; font-size:12px; color:#666;}
    .tools{display:flex; gap:10px; flex-wrap:wrap}
    .tools .btn{width:auto; padding:10px 14px}
    img#amivizLogo{max-height:40px}
  </style>
</head>

<body>
  <button id="secretAdmin" aria-label="Open admin tools"></button>

  <div class="wrap">
    <div class="card">
      <div class="hero">
        <!-- Try to load the provided PNG by name; fall back to brandmark if not present -->
        <img id="amivizLogo" src="AmiViz Logo - white bg.png" alt="AmiViz logo"
             onerror="this.style.display='none'; document.getElementById('brandmark').style.display='block';" />
        <div id="brandmark" class="brandmark" style="display:none;">AmiViz</div>
      </div>

      <h1>Event Registration</h1>
      <p class="subtitle">Please complete your details below. Only invited guests are confirmed.</p>

      <label for="fullName">Full Name</label>
      <input id="fullName" type="text" placeholder="Your full name" autocomplete="name" />

      <label for="company">Company</label>
      <input id="company" type="text" placeholder="Company name" autocomplete="organization" />

      <label for="email">Email Address</label>
      <input id="email" type="email" placeholder="name@company.com" autocomplete="email" />

      <label for="phone">Phone Number</label>
      <input id="phone" type="tel" placeholder="+974 1234 5678" autocomplete="tel" />

      <button class="btn" id="registerBtn">Register</button>
      <div id="error" class="err hidden"></div>
      <p class="note">We’ll review your submission and confirm invited registrations.</p>

      <!-- Admin Panel (hidden) -->
      <div id="adminPanel" class="card">
        <div style="display:flex;gap:8px;align-items:center;justify-content:space-between;">
          <h3>Admin Control Panel</h3>
          <span class="pill">local export</span>
        </div>
        <p class="note">Exports <b>invited</b> registrations stored in this browser.</p>
        <div class="tools">
          <button class="btn" id="downloadBtn" style="background:#0a7f49">Download Excel</button>
          <button class="btn" id="downloadCsvBtn" style="background:#0a6ca8">Download CSV</button>
          <button class="btn" id="clearBtn" style="background:#8c2b2b">Clear Local Data</button>
        </div>
      </div>
    </div>

    <!-- Page 2: Thank You (invited only) -->
    <div id="page2" class="card center hidden">
      <h2 class="success">Thank you for registering.</h2>
      <p>We look forward to meeting you soon at the event.</p>
    </div>

    <div class="footer">© AmiViz — Private Event</div>
  </div>

  <!-- Uninvited Popup -->
  <div id="popup" class="modal" role="dialog" aria-modal="true" aria-labelledby="pTitle">
    <div class="modal-inner">
      <h3 id="pTitle">Not on the Invited List</h3>
      <p>It looks like you were not an invited guest for this event.</p>
      <p>Please reach out to your <b>AmiViz</b> account manager to secure a pass.</p>
      <button class="close" id="closePopup">Close</button>
    </div>
  </div>

  <script>
    /* =========================
       CONFIG
       ========================= */
    const ADMIN_PASSCODE = "KAREENA2026";

    /* =========================
       INVITED EMAIL LIST
       (cleaned + lowercased)
       ========================= */
    const invitedEmails = [
      "dexter.casagnap@ahlibank.com.qa","nayef.qaddoura@ahlibank.com.qa","noura.kanaan@ahlibank.com.qa","eyibrahim@alfardan.com.qa","ntrad@alfardan.com.qa","nmajeed@alfardan.com.qa","munira@aljazeera.net","chowdhuryi@aljazeera.net","boodim@aljazeera.net","alasadh@aljazeera.net","t.aziz@almeera.com.qa","s.modi@almeera.com.qa","aealmehaizaa@diwan.gov.qa","skalromaihi@diwan.gov.qa","imtiaz@diwan.gov.qa","jsalkuwari@diwan.gov.qa","a.bouiadjra@ams.net.qa","abeer@ashghal.gov.qa","mshekh@ashghal.gov.qa","sabuthahir@ashghal.gov.qa","reda.elageli@aspirezone.qa","ramy.ahmed@aspirezone.qa","g.khalil@baladna.com","r.olimat@baladna.com","n.pottayil@baladna.com","malikm@bein.com","begovick@bein.net","benjamin.beaston@cbq.qa","daniel.onimowo@cbq.qa","kamran.saifullah@cbq.qa","kesav.anand@cbq.qa","muhammad.ahmed@cbq.qa","nikunj.desai@cbq.qa","abdullah.alghushami@ccq.edu.qa","jordan.momani@ccq.edu.qa","jouhar.saleh@ccq.edu.qa","alkuwaria@cb.gov.qa","albadrm@cb.gov.qa","alkuwarima@cb.gov.qa","kumarr@cb.gov.qa","fobeido@darwishholding.com","rgohil@darwishholding.com","asultan@dohabank.com.qa","daborjoe@dohabank.com.qa","msabit@dohabank.com.qa","sahimm@dohabank.com.qa","twakileh@dohabank.com.qa","salkhateeb@dohabank.com.qa","rinesh.nanu@dohaoasis.com","ronaldo.parlan@dohaoasis.com","youssef.ftouni@dohaoasis.com","hani.kamel@dolphinenergy.com","h.alkuwari@dukhanbank.com","r.varma@dukhanbank.com","a.moideen@dukhanbank.com","h.khalfan@dukhanbank.com","m.alslakhi@dukhanbank.com","m.shamseer@dukhanbank.com","r.mansouri@barwabank.com","t.hashmi@dukhanbank.com","a.george@dukhanbank.com","m.abdullahi@ezdanholding.qa","s.gaibee@ezdanholding.qa","n.perumbalath@ezdanholding.qa","mohammad.azizieh@fadaatmedia.com","radwan.younis@fadaatmedia.com","ali.alyafie@customs.gov.qa","shameer@customs.gov.qa","umairs@customs.gov.qa","abdelaziz@customs.gov.qa","talemadi@grsia.gov.qa","aelatrash@gta.gov.qa","eabounada@gta.gov.qa","laith@gco.gov.qa","raed.shaban@gdi.com.qa","ahmad.abdulhameed@gdi.com.qa","sherees.mohamed@gdi.com.qa","binoy.mathews@gwclogistics.com","pradeep.prabhakaran@gwclogistics.com","shabeer.edapagath@gwclogistics.com","adeel.akhtar@gwclogistics.com","smathai@hamadairport.com.qa","skadri@hamadairport.com.qa","ramsubbiah@hamadairport.com","dchoudhury@hamad.qa","ssyed@hamad.qa","vvasudevan@hamad.qa","aelghamry@hamad.qa","abduljabbar@km.qa","aaladsani@km.qa","broy@consultants.km.qa","aaljadaa@km.com.qa","mnabhan@km.qa","aneama@km.qa","eselmi@km.qa","makhan@lekhwiya.gov.qa","asalsubaey@lekhwiya.gov.qa","azaboumadi@lu.edu.qa","aelhaddad@lu.edu.qa","rsaad@lu.edu.qa","b.mustafa@manateq.qa","s.abusaada@manateq.qa","aamir.sohail@alrayan.com","adalarasu.m@alrayan.com","ahmad.abdullah@alrayan.com","ahmed.dhazaan@alrayan.com","anoop.varughese@alrayan.com","pichu@alrayan.com","glenn.fernandes@alrayan.com","muhammad.wahid@alrayan.com","ravdeep.sodhi@alrayan.com","sathish.rangaswamy@alrayan.com","najeeb.aboobacker@mcdonaldsqatar.com","aalmarwani@moci.gov.qa","akumbhar@moci.gov.qa","pramachandran@moci.gov.qa","ushaikh@co.moci.gov.qa","aaladawi@mcit.gov.qa","msenturk@mcit.gov.qa","msaleh@mcit.gov.qa","akadri@mcit.gov.qa","i.mohamed2309@education.qa","a.ibrahim07081@education.qa","tamer.m.sallam@gmail.com","klakdawala@mof.gov.qa","kmohamed@mof.gov.qa","yunus@mof.gov.qa","alnaemi@mofa.gov.qa","mhamar@mofa.gov.qa","ialemadi@mofa.gov.qa","mmarri@mofa.gov.qa","nalmaadeed@mofa.gov.qa","hahmed4@moi.gov.qa","uazhar@mm.gov.qa","ukhalid@mm.gov.qa","isyed@moph.gov.qa","sbashraheel@moph.gov.qa","sjoy@moph.gov.qa","tterk@moph.gov.qa","aelgayli@msdf.gov.qa","malnatour@msy.gov.qa","asiddiqui@mowasalat.com","sammar@mowasalat.com","skhalid@mowasalat.com","mwahab@mowasalat.com","afsarmy@outlook.com","cfranco@mowasalat.com","mjamal@mowasalat.com","dwankhede@msheireb.com","msamiullah@msheireb.com","salmaraghi@ncsa.gov.qa","razeen.abdul-gaffar@noc.qa","abubacker.mohaideen.ahamed.shah@noc.qa","gsharma@ooredoo.qa","gbhaskaran@ooredoo.qa","salmawlawi@ooredoo.qa","mohamed.hahnaf@oryxgtl.qa","z.kuthubdeen@oryxgtl.com.qa","akhattab@phcc.gov.qa","ahkhan@phcc.gov.qa","msimren@phcc.gov.qa","mohussain@phcc.gov.qa","arazak@pp.gov.qa","shajil@pp.gov.qa","zalkharman@pp.gov.qa","afdsouza@qatarairways.com.qa","ashaikh@qatarairways.com.qa","bwankhede@qatarairways.com.qa","ekhoury@qatarairways.com.qa","gvarughese@qatarairways.com.qa","jcortijoguijarro@qatarairways.com.qa","nvenkatesan@qatarairways.com.qa","pvizoso@qatarairways.com.qa","misaid@qatarairways.com.qa","ssayed@qatarairways.com.qa","ytadj@qatarairways.com.qa","vinaik@qatarairways.com.qa","msalali@qag.gov.qa","dkuriakose@qag.gov.qa","smaliyakkal@qag.gov.qa","radie@qcb.gov.qa","alobaidlyj@qcb.gov.qa","alfehanim@qcb.gov.qa","hassana@qcb.gov.qa","husains@qcb.gov.qa","ybarhoum@qcharity.org","zbelghith@qcharity.org","wabdallah@qcharity.org","jzaveri@qchem.com.qa","nahmad@qchem.com.qa","rdshaikh@qchem.com.qa","isedaqat@qatarcool.com","mansour@qatarcool.com","hradwan@qdb.qa","karim@qdb.qa","mahesh@qdb.qa","nehal@qdb.qa","hans@qdb.qa","mjoshi@qdb.qa","vaithy@qdb.qa","almaraghi@qatarenergy.qa","aboukass@qatarenergy.qa","mu_ahmed@qatarenergy.qa","sageorge@qatarenergylng.qa","mpathan@qafco.com.qa","yhamad@qafco.com.qa","okadiri@qafco.com.qa","a.merchant@qfc.qa","h.alzaini@qfc.qa","mkunjan@qf.org.qa","sprashant@qf.org.qa","sshaik@qfz.gov.qa","talazhar@qfz.gov.qa","masiddiqui@qatarenergylng.qa","sasaeed@qatarenergylng.qa","mali@nakilat.com","ssulochana@nakilat.com","waheed.r@nakilat.com","cmathew@qgtc.com.qa","hsuwaid@qgtc.com.qa","sammy.g@qatarshipyard.qa","ykhan@qgtc.com.qa","tploss@nakilat.com","a.abualhaija@qgirco.com","s.altalla@qgirco.com","h.abdelfattah@qgirco.com","m.elakhras@qgirco.com","abilash.devdas@anoudtechnologies.com","anand.selvakumar@qicgroup.com.qa","nagasai.gudlavalleti@anoudtechnologies.com","nagasai.gudlavalleti@qicgroup.com.qa","abhay.singh@qicgroup.com.qa","dhobert.pagaduan@qiib.com.qa","shazin.ali@qiib.com.qa","anugya.saraswat@qib.com.qa","faisal.chandle@qib.com.qa","ilyas.ersoz@qib.com.qa","sajeev.menon@qib.com.qa","samer.alfarra@qib.com.qa","shijo.thomas@qib.com.qa","siraj.shamsudheen@qib.com.qa","siyavudheen.kappoor@qib.com.qa","zara.sikandar@qib.com.qa","aamohamed@qmc.qa","mshatat@qmc.qa","rthomas@qmc.qa","hsyed@qm.org.qa","jalobaidli@qm.org.qa","nalsalahi@qm.org.qa","alex.constantinidis@qnb.com","angelos.printezis@qnb.com","ayman.hout@qnb.com","hussain.alneama@qnb.com","ibrahim.krishan@qnb.com","ibrahim.masloum@qnb.com","imad.atari@qnb.com","kiran.sebastian@qnb.com","mariya.sofi@qnb.com","mehbobuddin.ahmed@qnb.com","michal.blaszkiewicz@qnb.com","mohd.alsada@qnb.com","fatma.albaker@qnb.com","ramy.ghanem@qnb.com","ranga.kariyawasam@qnb.com","rajithkumar.jagadeesan@qnb.com","reem.alnaimi@qnb.com","reema.alkuwari@qnb.com","sultan.alsalem@qnb.com","tamer.abotaleb@qnb.com.qa","virgilio.viegas@qnb.com","yatish.bhat@qnb.com","abdullah.rencber@qnb.com","nasalansari@qnl.qa","a.manulal@qapco.com.qa","f.rashed@qapco.com.qa","i.yevide@qapco.com.qa","sfareedu@qapco.com.qa","it@qppc.net","mmakki@qatarposts.com","mrasheen@qatarposts.com","asalman@qr.com.qa","asmohammed@qr.com.qa","jakram@qr.com.qa","hmalik@qr.com.qa","nambar@qr.com.qa","srajendran@qr.com.qa","ali_syed@qatarsteel.com.qa","anis_kazi@qatarsteel.com.qa","ghazwan@qatarsteel.com.qa","saravanan.govindarasu@qatarsteel.com.qa","shuja@qu.edu.qa","thanzeer.h@qu.edu.qa","akayal@qataridiar.com","j.sreedharan@qatariinvestors.com","jmankarios@qinvest.com","skezheriyal@qinvest.com","bilal.rao@rkhqitarat.com","ganesh.iyer@rkhqitarat.com","hazeeb.hamza@rkhqitarat.com","aoumlil@sidra.org","skumar3@sidra.org","mjunaid@sidra.org","aali1@sidra.org","aladha@sidra.org","skardan@sidra.org","nikita@snoonu.com","hoda.t@snoonu.com","nina.f@snoonu.com","a.moaven@sponixtech.com","abdulla.alsaadi@sab.gov.qa","aju.joy@sab.gov.qa","jameela.alotaibi@sab.gov.qa","roqaya.alshaabi@sab.gov.qa","alsuwaidi@ssb.gov.qa","mishal.alibrahim@vodafone.qa","nawaf.alsowadi@vodafone.qa","naveed.kundi@vodafone.qa","syed.rasool@vodafone.qa","aralmarri@woqod.com.qa","asaleemuddin@woqod.com.qa","hasaidalavi@woqod.com.qa","rsatpathy@woqod.com.qa","ayusop@woqod.com.qa","tveedan@woqod.com.qa","parmar@amiviz.com"
    ];

    /* =========================
       STORAGE (local only)
       ========================= */
    let registrations = JSON.parse(localStorage.getItem("registrations") || "[]");

    /* =========================
       ELEMENTS
       ========================= */
    const el = id => document.getElementById(id);
    const registerBtn = el("registerBtn");
    const errorBox = el("error");
    const popup = el("popup");
    const closePopup = el("closePopup");
    const secretBtn = el("secretAdmin");
    const adminPanel = el("adminPanel");

    /* =========================
       REGISTER FLOW
       ========================= */
    registerBtn.addEventListener("click", () => {
      errorBox.classList.add("hidden");
      const name = el("fullName").value.trim();
      const company = el("company").value.trim();
      const email = el("email").value.trim().toLowerCase();
      const phone = el("phone").value.trim();

      if (!name || !company || !email || !phone) {
        return showError("Please fill all fields.");
      }
      if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
        return showError("Please enter a valid email address.");
      }

      if (invitedEmails.includes(email)) {
        // Save invited registration locally
        registrations.push({ name, company, email, phone, ts: new Date().toISOString() });
        localStorage.setItem("registrations", JSON.stringify(registrations));
        // Show Thank-you
        showPage(2);
        scrollTo(0,0);
      } else {
        // Not invited → popup on same page
        popup.style.display = "flex";
      }
    });

    /* =========================
       POPUP
       ========================= */
    closePopup.addEventListener("click", () => popup.style.display = "none");
    popup.addEventListener("click", (e) => {
      if (e.target === popup) popup.style.display = "none";
    });

    /* =========================
       INVISIBLE ADMIN TRIGGER
       Triple-click bottom-left hot area
       ========================= */
    let taps = 0, tapTimer = null;
    secretBtn.addEventListener("click", () => {
      if (!tapTimer) {
        tapTimer = setTimeout(() => { taps = 0; tapTimer = null; }, 1500);
      }
      taps++;
      if (taps >= 3) {
        clearTimeout(tapTimer); taps = 0; tapTimer = null;
        const code = prompt("Enter admin passcode:");
        if (code === "KAREENA2026") {
          adminPanel.style.display = "block";
        }
      }
    });

    /* =========================
       ADMIN: DOWNLOAD EXCEL / CSV
       ========================= */
    el("downloadBtn").addEventListener("click", () => {
      if (!registrations.length) return alert("No invited registrations in this browser yet.");
      if (typeof XLSX === "object" && XLSX.utils && XLSX.writeFile) {
        const data = [
          ["Name","Company","Email","Phone","Submitted At"],
          ...registrations.map(r => [r.name, r.company, r.email, r.phone, r.ts])
        ];
        const ws = XLSX.utils.aoa_to_sheet(data);
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "Invited Registrations");
        XLSX.writeFile(wb, "Invited_Registrations.xlsx");
      } else {
        // Fallback to CSV if Excel library not loaded
        downloadCsv();
      }
    });

    el("downloadCsvBtn").addEventListener("click", downloadCsv);

    function downloadCsv(){
      if (!registrations.length) return alert("No invited registrations in this browser yet.");
      const rows = [
        ["Name","Company","Email","Phone","Submitted At"],
        ...registrations.map(r => [r.name, r.company, r.email, r.phone, r.ts])
      ];
      const csv = rows.map(r => r.map(s => `"${String(s).replace(/"/g,'""')}"`).join(",")).join("\r\n");
      const blob = new Blob([csv], {type:"text/csv;charset=utf-8;"});
      const a = document.createElement("a");
      a.href = URL.createObjectURL(blob);
      a.download = "Invited_Registrations.csv";
      document.body.appendChild(a); a.click(); a.remove();
    }

    el("clearBtn").addEventListener("click", () => {
      if (confirm("Clear locally stored invited registrations on this device?")) {
        registrations = [];
        localStorage.removeItem("registrations");
        alert("Local data cleared.");
      }
    });

    /* =========================
       HELPERS
       ========================= */
    function showError(msg){
      errorBox.textContent = msg;
      errorBox.classList.remove("hidden");
    }
    function showPage(n){
      document.getElementById("page2").classList.add("hidden");
      if (n === 2) document.getElementById("page2").classList.remove("hidden");
    }
  </script>
</body>
</html>
``